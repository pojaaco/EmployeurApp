-- CREATE SEQUENCE number_count_seqqqq
--     START WITH 1
--     INCREMENT BY 1
--     NOCACHE
--     NOCYCLE;
--
-- CREATE OR REPLACE TRIGGER trg_number_count
-- BEFORE INSERT ON EMPLOYEUR
-- FOR EACH ROW
-- BEGIN
--     SELECT TO_CHAR(number_count_seqqqq.NEXTVAL, 'FM000000')
--     INTO :NEW.NUMBER_COUNT
--     FROM dual;
-- END;
-- /

ALTER TABLE EMPLOYEUR
    ADD CONSTRAINT chk_number_count_format
        CHECK (REGEXP_LIKE(NUMBER_COUNT, '^[0-9]{6}$'));

ALTER TABLE EMPLOYEUR
    ADD CONSTRAINT chk_number_ide_format
        CHECK (REGEXP_LIKE(NUMBER_IDE, '^(CHE|ADM)-[0-9]{3}\.[0-9]{3}\.[0-9]{3}$'));

ALTER TABLE EMPLOYEE
    ADD CONSTRAINT chk_number_avs_format
        CHECK (REGEXP_LIKE(NUMBER_AVS, '^756\.[0-9]{4}\.[0-9]{4}\.[0-9]{2}$'));


INSERT INTO EMPLOYEUR (CAISSE, NUMBER_COUNT, NUMBER_IDE, NAME, STARTING_DATE, END_DATE)
VALUES (1, '000001', 'CHE-111.222.334', '3AAA Treuhand GmbH', '01-Jan-2019', '31-Dec-2023');
INSERT INTO EMPLOYEUR (CAISSE, NUMBER_COUNT, NUMBER_IDE, NAME, STARTING_DATE, END_DATE)
VALUES (2, '000002', 'CHE-245.686.565', '9Punk GmbH', '01-Jan-2018', '30-Nov-2023');
INSERT INTO EMPLOYEUR (CAISSE, NUMBER_COUNT, NUMBER_IDE, NAME, STARTING_DATE, END_DATE)
VALUES (1, '000003', 'CHE-532.123.554', 'Skssg GmbH', '01-Feb-2018', '30-Nov-2025');


INSERT INTO EMPLOYEE (NUMBER_AVS, LAST_NAME, FIRST_NAME, STARTING_DATE, END_DATE, AMOUNT_OF_ASSURANCE_AVS, AMOUNT_OF_ASSURANCE_AC, AMOUNT_OF_ASSURANCE_AF, EMPLOYEUR_ID)
VALUES ('756.7566.8458.18', 'KNEZEVIC', 'KATA', '01-Jan-2023', '31-Dec-2023', 200000, 15000, 30000, 1);
INSERT INTO EMPLOYEE (NUMBER_AVS, LAST_NAME, FIRST_NAME, STARTING_DATE, END_DATE, AMOUNT_OF_ASSURANCE_AVS, AMOUNT_OF_ASSURANCE_AC, AMOUNT_OF_ASSURANCE_AF, EMPLOYEUR_ID)
VALUES ('756.8205.9052.92', 'ACERBI', 'ANNIBALe', '01-May-2023', '31-Dec-2023', 100000, 10000, 20000, 1);